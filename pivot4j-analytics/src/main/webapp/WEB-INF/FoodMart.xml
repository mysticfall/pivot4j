<?xml version="1.0"?>
<Schema name="Divida">

    <Cube name="Divida">
        <View alias="tb_analise_dividas_dim01">
            <SQL dialect="generic">
                <![CDATA[ select *from tb_analise_dividas_dim01 where cred_id_credor = %CREDOR%]]> 
            </SQL>
        </View>

        <Dimension name="Situação" foreignKey="situ_id_situacao">
            <Hierarchy hasAll="true" primaryKeyTable="tb_debito_situacoes" primaryKey="situ_id_situacao"  allMemberName="Todas situações">
                <Join leftKey="situ_id_situacao" rightKey="situ_id_situacao">
                    <Table name="tb_debito_situacoes"/>
                    <View alias="tb_analise_dividas_dim01">
                        <SQL dialect="generic">
                <![CDATA[ select *from tb_analise_dividas_dim01 where cred_id_credor = %CREDOR%]]> 
                        </SQL>
                    </View>
                </Join>
                <Level name="Situação" table="tb_debito_situacoes" column="situ_nm_situacao" uniqueMembers="true" type="String"/>
            </Hierarchy>
        </Dimension>
     
        <Dimension name="Fase" foreignKey="fase_sg_fase">
            <Hierarchy hasAll="true" primaryKeyTable="tb_debito_fases" primaryKey="fase_sg_fase" allMemberName="Todas fases">
                <Join leftKey="fase_sg_fase" rightKey="fase_sg_fase">
                    <Table name="tb_debito_fases"/>
                    <View alias="tb_analise_dividas_dim01">
                        <SQL dialect="generic">
                <![CDATA[ select *from tb_analise_dividas_dim01 where cred_id_credor = %CREDOR%]]> 
                        </SQL>
                    </View>
                </Join>
                <Level name="Fase" table="tb_debito_fases" column="fase_ds_fase" uniqueMembers="true" type="String"/>
            </Hierarchy>
        </Dimension>

        <Dimension name="Origem">
            <Hierarchy hasAll="true" allMemberName="Todas origens">
                <Level name="Origem" column="caor_sg_origem" uniqueMembers="true" type="String"/>
            </Hierarchy>
        </Dimension>
        
        <Dimension name="Bairro">
            <Hierarchy hasAll="true" allMemberName="Todos bairros">
                <Level name="Bairro" column="cada_ds_bairro" uniqueMembers="true" type="String"/>
            </Hierarchy>
        </Dimension>

        <Dimension name="Exercício" foreignKey="exer_nr_lancamento">
            <Hierarchy hasAll="true" primaryKeyTable="tb_exercicios" primaryKey="exer_nr_ano" allMemberName="Todos exercícios">
                <Join leftKey="exer_nr_ano" rightKey="exer_nr_lancamento">
                    <Table name="tb_exercicios"/>
                    <View alias="tb_analise_dividas_dim01">
                        <SQL dialect="generic">
                <![CDATA[ select *from tb_analise_dividas_dim01 where cred_id_credor = %CREDOR%]]> 
                        </SQL>
                    </View>
                </Join>
                <Level name="Exercício" table="tb_exercicios" column="exer_nr_ano" uniqueMembers="true" type="Integer"/>
            </Hierarchy>
        </Dimension>
        
        <Dimension name="Algum outro pago" foreignKey="possui_lancamentos_pagos">
            <Hierarchy hasAll="true" primaryKeyTable="tb_sn" primaryKey="sn_id" allMemberName="Todos">
                <Join leftKey="sn_id" rightKey="possui_lancamentos_pagos">
                    <Table name="tb_sn"/>
                    <View alias="tb_analise_dividas_dim01">
                        <SQL dialect="generic">
                <![CDATA[ select *from tb_analise_dividas_dim01 where cred_id_credor = %CREDOR%]]> 
                        </SQL>
                    </View>
                </Join>
                <Level name="Algum outro pago" table="tb_sn" column="sn_nm" uniqueMembers="true" type="String"/>
            </Hierarchy>
        </Dimension>
        
        <Dimension name="Prescrito" foreignKey="laid_st_prescrito">
            <Hierarchy hasAll="true" primaryKeyTable="tb_sn" primaryKey="sn_id" allMemberName="Prescritos">
                <Join leftKey="sn_id" rightKey="laid_st_prescrito">
                    <Table name="tb_sn"/>
                    <View alias="tb_analise_dividas_dim01">
                        <SQL dialect="generic">
                <![CDATA[ select *from tb_analise_dividas_dim01 where cred_id_credor = %CREDOR%]]> 
                        </SQL>
                    </View>
                </Join>
                <Level name="Prescrito" table="tb_sn" column="sn_nm" uniqueMembers="true" type="String"/>
            </Hierarchy>
        </Dimension>
        
        <Measure name="Valor atualizado" column="lava_vl_atualizado" aggregator="sum" formatString="R$ ###,###,###,##0.00"/>
    </Cube>
    
</Schema>